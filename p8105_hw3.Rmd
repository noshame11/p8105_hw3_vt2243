---
title: 'Homework #3'
author: "Vincent Tam"
date: "October 9, 2018"
output:
  github_document: default
---
```{r Library Package Setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
## Prepare Setup to Answer Problem 3
## Install Libraries
library(tidyverse)
library(rvest)
library(httr)
library(knitr)
## install.packages("devtools")
## devtools::install_github("p8105/p8105.datasets"); already installed but do not want to install every time
library(p8105.datasets)
data(brfss_smart2010)
```
Problem 1
```{r Clean and Wrangle Data to Prepare for Answering Questions, include = FALSE}
## Clean, Filter, Select, Mutate, and Separate Variables
brfss_data = 
  janitor::clean_names(dat = brfss_smart2010) %>%
  filter(topic == "Overall Health") %>%
  filter(response == "Excellent" | response == "Very Good" | response == "Good" | response == "Fair" | response == "Poor") %>%
  select(year, locationdesc, topic, response, data_value) %>%
  mutate(cleaned_response = as.factor(response)) %>%
  separate(locationdesc, into = c("state", "county"), sep = " - ")
```
```{r Answering Questions, eval = FALSE}
brfss_data_2002 =
  filter(brfss_data, year == "2002") %>%
  distinct(state, county) %>%
  count(state) %>%
  filter(n == 7)
## In 2002, which states were observed at 7 locations?
brfss_data_2002
```
In 2002, the following states had 7 locations: 
```{r Spaghetti Plotting}
## Spaghetti Plots
brfss_plot = 
  brfss_data %>%
  distinct(year, state, county) %>%
  select(year, state, county) %>%
  group_by(year, state) %>%
  mutate(count = n())
ggplot(brfss_plot, aes(x = year, y = count, color = state)) + geom_point() + geom_line()
```

## Making Table
```{r Table Making}
brfss_table =   
  brfss_data %>%
  filter(year == '2002' | year == '2006' | year == '2010') %>%
  filter(state == 'NY') %>%
  filter(response == 'Excellent') %>%
  mutate(data_value_numeric = as.numeric(data_value)) %>%
  group_by(year) %>%
  summarize(brfss_NYexcellentsd = sd(data_value_numeric), brfss_NYexcellentmean = mean(data_value_numeric))
brfss_table
```
```{r Average Proportions}
brfss_proportions =
  brfss_data %>%
  mutate(year_factor = as.factor('year')) %>%
  group_by(year_factor, state) %>%
  filter(response == 'Excellent' | response == 'Very Good') %>%
  mutate(data_value_numeric = as.numeric(data_value)) %>%
  summarize(brfss_excellentmean = mean('Excellent'), 
            brfss_verygoodmean = mean('Very Good'), 
            brfss_goodmean = mean(data_value_numeric),
            brfss_fairmean = mean(data_value_numeric),
            brfss_poormean = mean(data_value_numeric)) %>%
  mutate(response_proportions = factor('cleaned_response', levels = c('brfss_excellentmean', 'brfss_goodmean')))
brfss_proportions

## For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time

```

## Problem #2
```{r}
## install.packages("devtools")
## devtools::install_github("p8105/p8105.datasets"); already installed but do not want to install every time
##library(p8105.datasets); already installed but do not want to install every time
library(tidyverse)
```
```{r}
instacart_cleaned =
  instacart %>%
  janitor::clean_names() 
length(instacart_cleaned$aisle) 
  filter(aisle != 'missing') %>%
  group_by(aisle) %>%
  summarize(n = n())
```


