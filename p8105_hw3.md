Homework \#3
================
Vincent Tam
October 9, 2018

    ## -- Attaching packages --------------------------------------------------------------------------- tidyverse 1.2.1 --

    ## v ggplot2 3.0.0     v purrr   0.2.5
    ## v tibble  1.4.2     v dplyr   0.7.6
    ## v tidyr   0.8.1     v stringr 1.3.1
    ## v readr   1.1.1     v forcats 0.3.0

    ## -- Conflicts ------------------------------------------------------------------------------ tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

Problem 1 - Behavioral Risk Factors Surveillance System (BRFSS) Data

``` r
## Clean, Filter, Select, Mutate, and Separate Variables
brfss_data = 
  brfss_smart2010 %>%
## format the data to use appropriate variable names
  janitor::clean_names() %>%
## focus on the “Overall Health” topic
  filter(topic == "Overall Health") %>%
## include only responses from “Excellent” to “Poor”
  filter(response == "Excellent" | response == "Very Good" | response == "Good" | response == "Fair" | response == "Poor") %>%
## organize responses as a factor taking levels ordered from “Excellent” to “Poor”
  mutate(cleaned_response = as.factor(response)) %>%
  ## organize and select relevant columns for questions
  select(year, locationdesc, topic, response, data_value) %>%
  separate(locationdesc, into = c("state", "county"), sep = " - ")
```

Answers to Homework Questions

``` r
brfss_data_2002 =
  filter(brfss_data, year == "2002") %>%
  distinct(state, county) %>%
  count(state) %>%
  filter(n == 7)
## In 2002, which states were observed at 7 locations?
"In 2002, the following states had 7 locations:" 
```

    ## [1] "In 2002, the following states had 7 locations:"

``` r
brfss_data_2002
```

    ## # A tibble: 3 x 2
    ##   state     n
    ##   <chr> <int>
    ## 1 CT        7
    ## 2 FL        7
    ## 3 NC        7

``` r
## Spaghetti Plots
brfss_plot = 
  brfss_data %>%
  distinct(year, state, county) %>%
  select(year, state, county) %>%
  group_by(year, state) %>%
  mutate(count = n())
"Spaghetti Plot showing the number of locations in each state from 2002 to 2010."
```

    ## [1] "Spaghetti Plot showing the number of locations in each state from 2002 to 2010."

``` r
ggplot(brfss_plot, aes(x = year, y = count, color = state)) + geom_point() + geom_line()
```

![](p8105_hw3_files/figure-markdown_github/Spaghetti%20Plotting-1.png)

Making Table
------------

``` r
brfss_table =   
  brfss_data %>%
  filter(year == '2002' | year == '2006' | year == '2010') %>%
  filter(state == 'NY') %>%
  filter(response == 'Excellent') %>%
  mutate(data_value_numeric = as.numeric(data_value)) %>%
  group_by(year) %>%
  summarize(brfss_NYexcellentsd = sd(data_value_numeric), brfss_NYexcellentmean = mean(data_value_numeric))
brfss_table
```

    ## # A tibble: 3 x 3
    ##    year brfss_NYexcellentsd brfss_NYexcellentmean
    ##   <int>               <dbl>                 <dbl>
    ## 1  2002                4.49                  24.0
    ## 2  2006                4.00                  22.5
    ## 3  2010                3.57                  22.7

``` r
brfss_proportions =
  brfss_data %>%
  mutate(year_factor = as.factor('year')) %>%
  group_by(year_factor, state) %>%
  filter(response == 'Excellent' | response == 'Very Good') %>%
  mutate(data_value_numeric = as.numeric(data_value)) %>%
  summarize(brfss_excellentmean = mean('Excellent'), 
            brfss_verygoodmean = mean('Very Good'), 
            brfss_goodmean = mean(data_value_numeric),
            brfss_fairmean = mean(data_value_numeric),
            brfss_poormean = mean(data_value_numeric)) %>%
  mutate(response_proportions = factor('cleaned_response', levels = c('brfss_excellentmean', 'brfss_goodmean')))
```

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Excellent"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

    ## Warning in mean.default("Very Good"): argument is not numeric or logical:
    ## returning NA

``` r
brfss_proportions
```

    ## # A tibble: 51 x 8
    ## # Groups:   year_factor [1]
    ##    year_factor state brfss_excellent~ brfss_verygoodm~ brfss_goodmean
    ##    <fct>       <chr>            <dbl>            <dbl>          <dbl>
    ##  1 year        AK                  NA               NA           23.6
    ##  2 year        AL                  NA               NA           18.6
    ##  3 year        AR                  NA               NA           21.9
    ##  4 year        AZ                  NA               NA           21.4
    ##  5 year        CA                  NA               NA           23.3
    ##  6 year        CO                  NA               NA           24.4
    ##  7 year        CT                  NA               NA           26.4
    ##  8 year        DC                  NA               NA           27.4
    ##  9 year        DE                  NA               NA           20.0
    ## 10 year        FL                  NA               NA           NA  
    ## # ... with 41 more rows, and 3 more variables: brfss_fairmean <dbl>,
    ## #   brfss_poormean <dbl>, response_proportions <fct>

``` r
## For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time
```

Problem \#2
-----------

``` r
## install.packages("devtools")
## devtools::install_github("p8105/p8105.datasets"); already installed but do not want to install every time
##library(p8105.datasets); already installed but do not want to install every time
library(tidyverse)
data(instacart)
```

``` r
instacart_cleaned =
  instacart %>%
  janitor::clean_names() 
length(unique(instacart_cleaned$aisle)) 
```

``` r
most_ordered =
  instacart_cleaned %>%
  group_by(aisle_id) %>%
  summarize(n = n()) %>%
  filter(min_rank(desc(n))<6)
most_ordered
```

most\_ordered %&gt;% group\_by(aisle\_id, n) %&gt;% mutate(temp\_ranking = min\_rank(most\_ordered))

``` r
## most_ordered %>%
##  mutate(aisle_idnumeric = as.factor(aisle_id)) %>%
##  mutate(aisle_idnumeric = forcats::fct_reorder(aisle_id_numeric, n)) %>%
##  ggplot(most_ordered, aes(x = aisle_idnumeric) + geom_bar(stat = "identity") + scale_x_discrete(drop = FALSE))
```
